<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Usando un software GIS è possibile stimare se un tetto è o meno idoneo per un impianto fotovoltaico. E’ possibile fare la stessa cosa in Python? Te lo dico qui!">

<title>PyGIS Blog - Verificare il potenziale fotovoltaico di un tetto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../.././site_logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NG119N5L8N"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-NG119N5L8N', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Verificare il potenziale fotovoltaico di un tetto">
<meta property="og:description" content="Usando un software GIS è possibile stimare se un tetto è o meno idoneo per un impianto fotovoltaico. E' possibile fare la stessa cosa in Python? Te lo dico qui!">
<meta property="og:image" content="project_logo.jpg">
<meta property="og:site-name" content="PyGIS Blog">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../.././site_logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PyGIS Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://massimilianomoraca.it"><i class="bi bi-website" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Verificare il potenziale fotovoltaico di un tetto</h1>
                  <div>
        <div class="description">
          Usando un software GIS è possibile stimare se un tetto è o meno idoneo per un impianto fotovoltaico. E’ possibile fare la stessa cosa in Python? Te lo dico qui!
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">line</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Data di Pubblicazione</div>
      <div class="quarto-title-meta-contents">
        <p class="date">22 maggio 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">In questa pagina</h2>
   
  <ul>
  <li><a href="#prima-di-iniziare" id="toc-prima-di-iniziare" class="nav-link active" data-scroll-target="#prima-di-iniziare">Prima di iniziare</a>
  <ul class="collapse">
  <li><a href="#librerie" id="toc-librerie" class="nav-link" data-scroll-target="#librerie">Librerie</a></li>
  <li><a href="#fonti-dati" id="toc-fonti-dati" class="nav-link" data-scroll-target="#fonti-dati">Fonti dati</a></li>
  </ul></li>
  <li><a href="#lettura-dei-dati" id="toc-lettura-dei-dati" class="nav-link" data-scroll-target="#lettura-dei-dati">1. Lettura dei dati</a>
  <ul class="collapse">
  <li><a href="#visualizzazione-dei-dati-grezzi" id="toc-visualizzazione-dei-dati-grezzi" class="nav-link" data-scroll-target="#visualizzazione-dei-dati-grezzi">1.1 Visualizzazione dei dati grezzi</a></li>
  </ul></li>
  <li><a href="#analisi-dellinclinazione-dei-tetti" id="toc-analisi-dellinclinazione-dei-tetti" class="nav-link" data-scroll-target="#analisi-dellinclinazione-dei-tetti">2. Analisi dell’inclinazione dei tetti</a>
  <ul class="collapse">
  <li><a href="#tetti-piani" id="toc-tetti-piani" class="nav-link" data-scroll-target="#tetti-piani">2.1 Tetti piani</a></li>
  <li><a href="#tetti-con-inclinazione-ottimale" id="toc-tetti-con-inclinazione-ottimale" class="nav-link" data-scroll-target="#tetti-con-inclinazione-ottimale">2.2 Tetti con inclinazione ottimale</a></li>
  </ul></li>
  <li><a href="#analisi-dellorientamento-dei-tetti" id="toc-analisi-dellorientamento-dei-tetti" class="nav-link" data-scroll-target="#analisi-dellorientamento-dei-tetti">3. Analisi dell’orientamento dei tetti</a>
  <ul class="collapse">
  <li><a href="#tetti-esposti-a-sud" id="toc-tetti-esposti-a-sud" class="nav-link" data-scroll-target="#tetti-esposti-a-sud">3.1 Tetti esposti a SUD</a></li>
  <li><a href="#tetti-esposti-ad-est" id="toc-tetti-esposti-ad-est" class="nav-link" data-scroll-target="#tetti-esposti-ad-est">3.2 Tetti esposti ad EST</a></li>
  <li><a href="#tetti-esposti-ad-ovest" id="toc-tetti-esposti-ad-ovest" class="nav-link" data-scroll-target="#tetti-esposti-ad-ovest">3.2 Tetti esposti ad OVEST</a></li>
  </ul></li>
  <li><a href="#produzione-energetica-stimata" id="toc-produzione-energetica-stimata" class="nav-link" data-scroll-target="#produzione-energetica-stimata">4. Produzione energetica stimata</a>
  <ul class="collapse">
  <li><a href="#put-them-all-togheter" id="toc-put-them-all-togheter" class="nav-link" data-scroll-target="#put-them-all-togheter">4.1 Put them all togheter</a></li>
  <li><a href="#individuazione-dei-tetti-con-pendenza-ed-esposizione-ottimali" id="toc-individuazione-dei-tetti-con-pendenza-ed-esposizione-ottimali" class="nav-link" data-scroll-target="#individuazione-dei-tetti-con-pendenza-ed-esposizione-ottimali">4.2 Individuazione dei tetti con pendenza ed esposizione ottimali</a></li>
  <li><a href="#stima-del-potenziale-produttivo" id="toc-stima-del-potenziale-produttivo" class="nav-link" data-scroll-target="#stima-del-potenziale-produttivo">4.3 Stima del potenziale produttivo</a></li>
  </ul></li>
  <li><a href="#conclusione" id="toc-conclusione" class="nav-link" data-scroll-target="#conclusione">Conclusione</a>
  <ul class="collapse">
  <li><a href="#newsletter" id="toc-newsletter" class="nav-link" data-scroll-target="#newsletter">Newsletter</a></li>
  <li><a href="#telegram" id="toc-telegram" class="nav-link" data-scroll-target="#telegram">Telegram</a></li>
  <li><a href="#offrimi-una-birra" id="toc-offrimi-una-birra" class="nav-link" data-scroll-target="#offrimi-una-birra">Offrimi una birra!</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Un po’ di tempo fa ho effettuato un’analisi finalizzata a stimare il <a href="https://massimilianomoraca.it/blog/gis/fotovoltaico-e-gis-come-individuare-lutilizzabilita-di-un-tetto/">potenziale fotovoltaico</a> di un tetto usando QGIS. Con questo articolo voglio ripercorrere lo stesso flusso di lavoro usando però Python!</p>
<section id="prima-di-iniziare" class="level2">
<h2 class="anchored" data-anchor-id="prima-di-iniziare">Prima di iniziare</h2>
<section id="librerie" class="level3">
<h3 class="anchored" data-anchor-id="librerie">Librerie</h3>
<p>Per raggiungere l’obiettivo userò le librerie che seguono:</p>
<div class="cell" data-execution_count="1">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pathlib</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> rioxarray <span class="im">as</span> rxr</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> contextily <span class="im">as</span> cx</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xrspatial.aspect <span class="im">import</span> aspect</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> xrspatial.slope <span class="im">import</span> slope</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="fonti-dati" class="level3">
<h3 class="anchored" data-anchor-id="fonti-dati">Fonti dati</h3>
<div class="cell" data-execution_count="2">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="op">=</span> pathlib.Path.cwd().parent.joinpath(<span class="st">'sample_data/photovoltaic_potential_analysis'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dsm <span class="op">=</span> sample_data.joinpath(<span class="st">'dsm.tif'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>buildings <span class="op">=</span> sample_data.joinpath(<span class="st">'buildings_footprint.shp'</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="lettura-dei-dati" class="level1">
<h1>1. Lettura dei dati</h1>
<div class="cell" data-execution_count="3">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>raster <span class="op">=</span> rxr.open_rasterio(dsm, masked<span class="op">=</span><span class="va">True</span>).squeeze()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>raster</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">

<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewbox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewbox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class="xr-text-repr-fallback">&lt;xarray.DataArray (y: 500, x: 500)&gt;
[250000 values with dtype=float32]
Coordinates:
    band         int64 1
  * x            (x) float64 4.445e+05 4.445e+05 4.445e+05 ... 4.45e+05 4.45e+05
  * y            (y) float64 4.529e+06 4.529e+06 ... 4.529e+06 4.529e+06
    spatial_ref  int64 0
Attributes:
    scale_factor:  1.0
    add_offset:    0.0</pre><div class="xr-wrap" style="display:none"><div class="xr-header"><div class="xr-obj-type">xarray.DataArray</div><div class="xr-array-name"></div><ul class="xr-dim-list"><li><span class="xr-has-index">y</span>: 500</li><li><span class="xr-has-index">x</span>: 500</li></ul></div><ul class="xr-sections"><li class="xr-section-item"><div class="xr-array-wrap"><input id="section-2c81b2fc-05f8-4d25-b614-d738f3775551" class="xr-array-in" type="checkbox" checked=""><label for="section-2c81b2fc-05f8-4d25-b614-d738f3775551" title="Show/hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-array-preview xr-preview"><span>...</span></div><div class="xr-array-data"><pre>[250000 values with dtype=float32]</pre></div></div></li><li class="xr-section-item"><input id="section-c57ea8f2-104e-466f-b22d-6ac03dd7ce64" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-c57ea8f2-104e-466f-b22d-6ac03dd7ce64" class="xr-section-summary">Coordinates: <span>(4)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><ul class="xr-var-list"><li class="xr-var-item"><div class="xr-var-name"><span>band</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">1</div><input id="attrs-6b15e360-7885-49a4-821a-f3df8402ca82" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-6b15e360-7885-49a4-821a-f3df8402ca82" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-5bdc8114-ff26-4cd4-a4be-fcc7f6305f36" class="xr-var-data-in" type="checkbox"><label for="data-5bdc8114-ff26-4cd4-a4be-fcc7f6305f36" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array(1)</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">x</span></div><div class="xr-var-dims">(x)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">4.445e+05 4.445e+05 ... 4.45e+05</div><input id="attrs-cfaacc14-8109-4815-b0db-94ab6210e73a" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-cfaacc14-8109-4815-b0db-94ab6210e73a" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-1b19f403-7ec5-4c5d-8f59-29e0d4142707" class="xr-var-data-in" type="checkbox"><label for="data-1b19f403-7ec5-4c5d-8f59-29e0d4142707" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([444495.808, 444496.808, 444497.808, ..., 444992.808, 444993.808,
       444994.808])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span class="xr-has-index">y</span></div><div class="xr-var-dims">(y)</div><div class="xr-var-dtype">float64</div><div class="xr-var-preview xr-preview">4.529e+06 4.529e+06 ... 4.529e+06</div><input id="attrs-6f6e1fa7-075b-4974-be29-caa301f67c4c" class="xr-var-attrs-in" type="checkbox" disabled=""><label for="attrs-6f6e1fa7-075b-4974-be29-caa301f67c4c" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-cf34748f-9393-46a0-998c-d6fd5fdafda8" class="xr-var-data-in" type="checkbox"><label for="data-cf34748f-9393-46a0-998c-d6fd5fdafda8" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"></dl></div><div class="xr-var-data"><pre>array([4529407.911, 4529406.911, 4529405.911, ..., 4528910.911, 4528909.911,
       4528908.911])</pre></div></li><li class="xr-var-item"><div class="xr-var-name"><span>spatial_ref</span></div><div class="xr-var-dims">()</div><div class="xr-var-dtype">int64</div><div class="xr-var-preview xr-preview">0</div><input id="attrs-cfa31464-7f51-43ea-ac8d-f386498b23e0" class="xr-var-attrs-in" type="checkbox"><label for="attrs-cfa31464-7f51-43ea-ac8d-f386498b23e0" title="Show/Hide attributes"><svg class="icon xr-icon-file-text2"><use href="#icon-file-text2"></use></svg></label><input id="data-bc7ddbab-a126-4c2c-a91a-ddf275976b37" class="xr-var-data-in" type="checkbox"><label for="data-bc7ddbab-a126-4c2c-a91a-ddf275976b37" title="Show/Hide data repr"><svg class="icon xr-icon-database"><use href="#icon-database"></use></svg></label><div class="xr-var-attrs"><dl class="xr-attrs"><dt><span>crs_wkt :</span></dt><dd>PROJCS["WGS 84 / UTM zone 33N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",15],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","32633"]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>horizontal_datum_name :</span></dt><dd>World Geodetic System 1984</dd><dt><span>projected_crs_name :</span></dt><dd>WGS 84 / UTM zone 33N</dd><dt><span>grid_mapping_name :</span></dt><dd>transverse_mercator</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>0.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>15.0</dd><dt><span>false_easting :</span></dt><dd>500000.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>scale_factor_at_central_meridian :</span></dt><dd>0.9996</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS["WGS 84 / UTM zone 33N",GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",15],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","32633"]]</dd><dt><span>GeoTransform :</span></dt><dd>444495.308 1.0 0.0 4529408.411 0.0 -1.0</dd></dl></div><div class="xr-var-data"><pre>array(0)</pre></div></li></ul></div></li><li class="xr-section-item"><input id="section-d6646e20-2a33-4f0b-a165-fc8afe03619b" class="xr-section-summary-in" type="checkbox" checked=""><label for="section-d6646e20-2a33-4f0b-a165-fc8afe03619b" class="xr-section-summary">Attributes: <span>(2)</span></label><div class="xr-section-inline-details"></div><div class="xr-section-details"><dl class="xr-attrs"><dt><span>scale_factor :</span></dt><dd>1.0</dd><dt><span>add_offset :</span></dt><dd>0.0</dd></dl></div></li></ul></div></div>
</div>
</div>
<div class="cell" data-execution_count="4">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>vector <span class="op">=</span> gpd.read_file(buildings)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>vector</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>id</th>
      <th>layer</th>
      <th>tipoedific</th>
      <th>uso</th>
      <th>sup_m2</th>
      <th>altezza</th>
      <th>altez_dsm</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0201N-Edificio Generico Nuovo</td>
      <td>Edificio generico</td>
      <td>Abitazione</td>
      <td>54</td>
      <td>4.67</td>
      <td>36.77</td>
      <td>POLYGON ((444654.507 4529354.495, 444651.839 4...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0201N-Edificio Generico Nuovo</td>
      <td>Edificio generico</td>
      <td>Abitazione</td>
      <td>49</td>
      <td>7.60</td>
      <td>40.79</td>
      <td>POLYGON ((444639.838 4529162.951, 444638.794 4...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0208N-Baracca Nuovo</td>
      <td>Baracca</td>
      <td>Altro</td>
      <td>23</td>
      <td>3.30</td>
      <td>38.11</td>
      <td>POLYGON ((444726.330 4529069.704, 444730.929 4...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0208I-Baracca Invariato</td>
      <td>Baracca</td>
      <td>Altro</td>
      <td>22</td>
      <td>3.19</td>
      <td>37.95</td>
      <td>POLYGON ((444523.992 4529241.197, 444523.992 4...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0208I-Baracca Invariato</td>
      <td>Baracca</td>
      <td>Altro</td>
      <td>55</td>
      <td>3.96</td>
      <td>38.68</td>
      <td>POLYGON ((444518.076 4529233.077, 444518.192 4...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>312</th>
      <td>312</td>
      <td>0201I-Edificio Generico Invariato</td>
      <td>Edificio generico</td>
      <td>Abitazione</td>
      <td>187</td>
      <td>10.57</td>
      <td>42.86</td>
      <td>POLYGON ((444676.418 4529355.727, 444676.008 4...</td>
    </tr>
    <tr>
      <th>313</th>
      <td>313</td>
      <td>0201M-Edificio Generico Modificato</td>
      <td>Edificio generico</td>
      <td>Abitazione</td>
      <td>323</td>
      <td>7.41</td>
      <td>42.35</td>
      <td>POLYGON ((444545.683 4529221.436, 444524.605 4...</td>
    </tr>
    <tr>
      <th>314</th>
      <td>314</td>
      <td>0201I-Edificio Generico Invariato</td>
      <td>Edificio generico</td>
      <td>Abitazione</td>
      <td>370</td>
      <td>2.88</td>
      <td>35.15</td>
      <td>POLYGON ((444723.780 4529165.567, 444719.890 4...</td>
    </tr>
    <tr>
      <th>315</th>
      <td>315</td>
      <td>0201M-Edificio Generico Modificato</td>
      <td>Edificio generico</td>
      <td>Abitazione</td>
      <td>2389</td>
      <td>11.78</td>
      <td>45.07</td>
      <td>POLYGON ((444848.335 4529111.537, 444850.324 4...</td>
    </tr>
    <tr>
      <th>316</th>
      <td>316</td>
      <td>0201M-Edificio Generico Modificato</td>
      <td>Edificio generico</td>
      <td>Abitazione</td>
      <td>2389</td>
      <td>11.78</td>
      <td>45.07</td>
      <td>POLYGON ((444860.572 4529113.825, 444863.015 4...</td>
    </tr>
  </tbody>
</table>
<p>317 rows × 8 columns</p>
</div>
</div>
</div>
<section id="visualizzazione-dei-dati-grezzi" class="level2">
<h2 class="anchored" data-anchor-id="visualizzazione-dei-dati-grezzi">1.1 Visualizzazione dei dati grezzi</h2>
<div class="cell" data-execution_count="5">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>raster.plot.imshow(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'Blues'</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"DSM"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y coordinates (meters)"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X coordinates (meters)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>Text(0.5, 0, 'X coordinates (meters)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-6-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>aoi <span class="op">=</span> vector.plot(alpha<span class="op">=</span><span class="fl">0.75</span>, color<span class="op">=</span><span class="st">"blue"</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cx.add_basemap(aoi, crs<span class="op">=</span>vector.crs.to_string(), source<span class="op">=</span>cx.providers.OpenStreetMap.Mapnik)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>aoi.set_title(<span class="st">"Area of Interest"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>Text(0.5, 1.0, 'Area of Interest')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-7-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="analisi-dellinclinazione-dei-tetti" class="level1">
<h1>2. Analisi dell’inclinazione dei tetti</h1>
<p>Come primo passo in questa analisi estrarrò dal DSM i soli edifici.</p>
<div class="cell" data-execution_count="7">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>raster_clipped <span class="op">=</span> raster.rio.clip(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    geometries<span class="op">=</span>vector.geometry, crs<span class="op">=</span>raster.rio.crs, all_touched<span class="op">=</span><span class="va">True</span>, drop<span class="op">=</span><span class="va">True</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>).squeeze()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>raster_clipped.plot.imshow(</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'Blues'</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"DEM of buildings footprint"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y coordinates (meters)"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X coordinates (meters)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>Text(0.5, 0, 'X coordinates (meters)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-8-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>A questo punto posso concentrarmi solo sui tetti calcolando la loro pendenza.</p>
<div class="cell" data-execution_count="8">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rooftop_slope <span class="op">=</span> slope(raster_clipped)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>colormap <span class="op">=</span> plt.cm.get_cmap(<span class="st">'RdYlGn'</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>rooftop_slope.plot.imshow(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span>colormap.<span class="bu">reversed</span>(),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Rooftop's slope"</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y coordinates (meters)"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X coordinates (meters)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>Text(0.5, 0, 'X coordinates (meters)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-9-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Le pendenze fanno riferimento al piano cartografico. Quindi 0° fa riferimento ad un tetto piano, con 85.8° di pendenza abbiamo un tetto quasi verticale e quindi ortogonale al piano cartografico.</p>
<p>La resa di un pannello fotovoltaico varia in base all’inclinazione rispetto ai raggi solari. Alle latitudini italiane la resa ottimale in fase di produzione di energia si ha quando i pannelli sono installati con una pendenza che varia tra i 30° ed i 40°. La pendenza ottimale è direttamente proporzionale alla <a href="https://it.wikipedia.org/wiki/Latitudine">latitudine</a>; più ci allontaniamo dall’equatore, più essa aumenta. Quindi nel sud Italia la pendenza ottimale si aggira intorno ai 30° mentre nel nord è intorno ai 40°. Non mi interessa entrare troppo nel dettaglio tecnico legato all’installazione di un impianto fotovoltaico ma dare una stima, una indicazione di produzione energetica, ma il passaggio sull’inclinazione è importante perchè con queste informazioni andrò ad effettuare le analisi successive suddividendo le pendenze dei tetti in tre classi: - 0 - 3° - 3° - 40° - 40° - 90°</p>
<p>Questa suddivisione mi consentirà di individuare sia i tetti piani(quelli che rientrano nella prima classe) che i tetti con la giusta inclinazione per una installazione in pendenza ottimale dell’impianto, consentendomi di escludere quelli con pendenze non ottimali(terza ed ultima classe).</p>
<p>Qui magari, con questa esclusione, storce il naso un installatore di impianti fotovoltaici perchè ci sono soluzioni tecniche che consentono di ovviare il problema della pendenza eccessiva del tetto. Conosco questi aspetti ma a me interessa dare una visione di metodologia di analisi con questo articolo.</p>
<section id="tetti-piani" class="level2">
<h2 class="anchored" data-anchor-id="tetti-piani">2.1 Tetti piani</h2>
<div class="cell" data-execution_count="9">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plane_rooftop <span class="op">=</span> rooftop_slope.where(rooftop_slope <span class="op">&lt;=</span> <span class="dv">3</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>colormap <span class="op">=</span> plt.cm.get_cmap(<span class="st">'RdYlGn'</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>plane_rooftop.plot.imshow(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span>colormap.<span class="bu">reversed</span>(),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Plane rooftops"</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y coordinates (meters)"</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X coordinates (meters)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>Text(0.5, 0, 'X coordinates (meters)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="tetti-con-inclinazione-ottimale" class="level2">
<h2 class="anchored" data-anchor-id="tetti-con-inclinazione-ottimale">2.2 Tetti con inclinazione ottimale</h2>
<div class="cell" data-execution_count="10">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>optimum_rooftop_inclination <span class="op">=</span> rooftop_slope.where((rooftop_slope <span class="op">&gt;</span> <span class="dv">3</span>) <span class="op">&amp;</span> (rooftop_slope <span class="op">&lt;=</span> <span class="dv">40</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>colormap <span class="op">=</span> plt.cm.get_cmap(<span class="st">'RdYlGn'</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>optimum_rooftop_inclination.plot.imshow(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span>colormap.<span class="bu">reversed</span>(),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Rooftops with slope between 3° and 40°"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y coordinates (meters)"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X coordinates (meters)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Text(0.5, 0, 'X coordinates (meters)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="analisi-dellorientamento-dei-tetti" class="level1">
<h1>3. Analisi dell’orientamento dei tetti</h1>
<p>Individuate le pendenze del tetto, passiamo a considerare l’aspetto relativo all’esposizione, o orientamento, del tetto.</p>
<p>Per il discorso lagato alla resa migliore in fase di produzione di energia, anche l’orientamento del tetto è un fattore chiave. Per un tetto piano è insignificante parlare di esposizione, concetto che diventa fondamentale per un tetto inclinato. Anche qui ci sono soluzioni tecniche che possono risolvere problemi di esposizione ma, come scritto poco sopra, non è questo il luogo per approfondire questi aspetti.</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>rooftop_aspect <span class="op">=</span> aspect(raster_clipped)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>rooftop_aspect.plot.imshow(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'Set2'</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Rooftop's aspect"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y coordinates (meters)"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X coordinates (meters)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Text(0.5, 0, 'X coordinates (meters)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>L’esposizione ottimale è il SUD(<em>tra 135° e 225°</em>), quella sicuramente da scartare è il NORD(<em>tra 0° e 45°, tra 315° e 360°</em>). <img src="https://as1.ftcdn.net/v2/jpg/01/74/27/88/500_F_174278831_b9BzZLu9tZNFKyT72vxL4TQuuEXmc7e4.jpg" title="Rosa dei venti | Immagine concessa con Licenza Standard Adobe" class="img-fluid" alt="Rosa dei venti"></p>
<p>Io andrò ad estrarre solo i tetti con esposizione da <strong>EST</strong> a <strong>SUD-EST</strong>, da <strong>SUD-EST</strong> a <strong>SUD-OVEST</strong> ad <strong>OVEST</strong>, quindi: - 90° - 135° - 135° - 225° - 225° - 270°</p>
<section id="tetti-esposti-a-sud" class="level2">
<h2 class="anchored" data-anchor-id="tetti-esposti-a-sud">3.1 Tetti esposti a SUD</h2>
<div class="cell" data-execution_count="12">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sud_rooftop_aspect <span class="op">=</span> rooftop_aspect.where((rooftop_aspect <span class="op">&gt;=</span> <span class="dv">135</span>) <span class="op">&amp;</span> (rooftop_aspect <span class="op">&lt;=</span> <span class="dv">225</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>sud_rooftop_aspect.plot.imshow(</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'Set2'</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Rooftops facing to SUD"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y coordinates (meters)"</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X coordinates (meters)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Text(0.5, 0, 'X coordinates (meters)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-13-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="tetti-esposti-ad-est" class="level2">
<h2 class="anchored" data-anchor-id="tetti-esposti-ad-est">3.2 Tetti esposti ad EST</h2>
<div class="cell" data-execution_count="13">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>est_rooftop_aspect <span class="op">=</span> rooftop_aspect.where((rooftop_aspect <span class="op">&gt;=</span> <span class="dv">90</span>) <span class="op">&amp;</span> (rooftop_aspect <span class="op">&lt;</span> <span class="dv">135</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>est_rooftop_aspect.plot.imshow(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'Set2'</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Rooftops facing to EST"</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y coordinates (meters)"</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X coordinates (meters)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>Text(0.5, 0, 'X coordinates (meters)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-14-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="tetti-esposti-ad-ovest" class="level2">
<h2 class="anchored" data-anchor-id="tetti-esposti-ad-ovest">3.2 Tetti esposti ad OVEST</h2>
<div class="cell" data-execution_count="14">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>ovest_rooftop_aspect <span class="op">=</span> rooftop_aspect.where((rooftop_aspect <span class="op">&gt;</span> <span class="dv">225</span>) <span class="op">&amp;</span> (rooftop_aspect <span class="op">&lt;=</span> <span class="dv">270</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>ovest_rooftop_aspect.plot.imshow(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'Set2'</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Rooftops facing to OVEST"</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Y coordinates (meters)"</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"X coordinates (meters)"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Text(0.5, 0, 'X coordinates (meters)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="produzione-energetica-stimata" class="level1">
<h1>4. Produzione energetica stimata</h1>
<p>Ora che ho una chiara idea delle aree di intervento procederò a stimare la produzione energetica dei tetti presenti nell’area in esame. Prima però è necessario affinare ulteriormente i dati.</p>
<section id="put-them-all-togheter" class="level2">
<h2 class="anchored" data-anchor-id="put-them-all-togheter">4.1 Put them all togheter</h2>
<div class="cell" data-execution_count="15">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>target_slope_rooftop <span class="op">=</span> rooftop_slope.where(rooftop_slope <span class="op">&lt;=</span> <span class="dv">40</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>colormap <span class="op">=</span> plt.cm.get_cmap(<span class="st">'RdYlGn'</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>target_slope_rooftop.plot.imshow(</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span>colormap.<span class="bu">reversed</span>(),</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>axs[<span class="dv">0</span>],</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Target rooftops based on slope"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>rooftop_slope.plot.imshow(</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span>colormap.<span class="bu">reversed</span>(),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>axs[<span class="dv">1</span>]</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Rooftop's slope"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>Text(0.5, 1.0, "Rooftop's slope")</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="16">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>target_aspect_rooftop <span class="op">=</span> rooftop_aspect.where((rooftop_aspect <span class="op">&gt;=</span> <span class="dv">90</span>) <span class="op">&amp;</span> (rooftop_aspect <span class="op">&lt;=</span> <span class="dv">270</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>target_aspect_rooftop.plot.imshow(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'Set2'</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>axs[<span class="dv">0</span>]</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Target rooftops based on aspect"</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>rooftop_aspect.plot.imshow(</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'Set2'</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>axs[<span class="dv">1</span>]</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Rooftop's aspect"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>Text(0.5, 1.0, "Rooftop's aspect")</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="individuazione-dei-tetti-con-pendenza-ed-esposizione-ottimali" class="level2">
<h2 class="anchored" data-anchor-id="individuazione-dei-tetti-con-pendenza-ed-esposizione-ottimali">4.2 Individuazione dei tetti con pendenza ed esposizione ottimali</h2>
<div class="cell" data-execution_count="17">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>target_slope_rooftop_mask <span class="op">=</span> ((target_slope_rooftop <span class="op">/</span> target_slope_rooftop) <span class="op">&gt;=</span> <span class="dv">1</span>).astype(<span class="st">'uint8'</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>target_aspect_rooftop_mask <span class="op">=</span> ((target_aspect_rooftop <span class="op">/</span> target_aspect_rooftop) <span class="op">&gt;=</span> <span class="dv">1</span>).astype(<span class="st">'uint8'</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>target_slope_rooftop_mask.plot.imshow(</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">"gray"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>axs[<span class="dv">0</span>],</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Target rooftops based on slope"</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>target_aspect_rooftop_mask.plot.imshow(</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">"gray"</span>,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span>axs[<span class="dv">1</span>]</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Target rooftops based on aspect"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>Text(0.5, 1.0, 'Target rooftops based on aspect')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="18">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>target_rooftop <span class="op">=</span> target_slope_rooftop_mask <span class="op">*</span> target_aspect_rooftop_mask</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>target_rooftop.plot.imshow(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'gray'</span>,</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Target rooftops"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Text(0.5, 1.0, 'Target rooftops')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="stima-del-potenziale-produttivo" class="level2">
<h2 class="anchored" data-anchor-id="stima-del-potenziale-produttivo">4.3 Stima del potenziale produttivo</h2>
<p>Ora che è chiaro quali sono i tetti potenzialmente utilizzabili è possibile calcolarne la produzione.</p>
<p>Il primo passo da seguire è convertire il <code>DataArray</code> creato in precedenza in un <code>DataFrame</code>.</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>target_rooftop_df <span class="op">=</span> target_rooftop.to_dataframe(name<span class="op">=</span><span class="st">"value"</span>).reset_index()</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>target_rooftop_df <span class="op">=</span> target_rooftop_df[target_rooftop_df[<span class="st">'value'</span>] <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>target_rooftop_df <span class="op">=</span> target_rooftop_df[[<span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'value'</span>]]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>target_rooftop_df</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1951</th>
      <td>444946.808</td>
      <td>4529404.911</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>444947.808</td>
      <td>4529404.911</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>444948.808</td>
      <td>4529404.911</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>444949.808</td>
      <td>4529404.911</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2455</th>
      <td>444950.808</td>
      <td>4529403.911</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>248266</th>
      <td>444761.808</td>
      <td>4528911.911</td>
      <td>1</td>
    </tr>
    <tr>
      <th>248267</th>
      <td>444762.808</td>
      <td>4528911.911</td>
      <td>1</td>
    </tr>
    <tr>
      <th>248268</th>
      <td>444763.808</td>
      <td>4528911.911</td>
      <td>1</td>
    </tr>
    <tr>
      <th>248269</th>
      <td>444764.808</td>
      <td>4528911.911</td>
      <td>1</td>
    </tr>
    <tr>
      <th>248767</th>
      <td>444762.808</td>
      <td>4528910.911</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>25141 rows × 3 columns</p>
</div>
</div>
</div>
<p>In questo modo si è ottenuto un oggetto che contiene i centroidi dei pixel del raster precedente, con i soli valori di interesse. Il passo successivo è convertire in <code>GeoDataFrame</code> il dataset ottenuto in precedenza.</p>
<div class="cell" data-execution_count="20">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>gdf_point <span class="op">=</span> gpd.GeoDataFrame(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    target_rooftop_df.value,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    geometry<span class="op">=</span>gpd.points_from_xy(target_rooftop_df.x,target_rooftop_df.y),</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    crs<span class="op">=</span>raster.rio.crs.to_string()</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>gdf_point</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>value</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1951</th>
      <td>1</td>
      <td>POINT (444946.808 4529404.911)</td>
    </tr>
    <tr>
      <th>1952</th>
      <td>1</td>
      <td>POINT (444947.808 4529404.911)</td>
    </tr>
    <tr>
      <th>1953</th>
      <td>1</td>
      <td>POINT (444948.808 4529404.911)</td>
    </tr>
    <tr>
      <th>1954</th>
      <td>1</td>
      <td>POINT (444949.808 4529404.911)</td>
    </tr>
    <tr>
      <th>2455</th>
      <td>1</td>
      <td>POINT (444950.808 4529403.911)</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>248266</th>
      <td>1</td>
      <td>POINT (444761.808 4528911.911)</td>
    </tr>
    <tr>
      <th>248267</th>
      <td>1</td>
      <td>POINT (444762.808 4528911.911)</td>
    </tr>
    <tr>
      <th>248268</th>
      <td>1</td>
      <td>POINT (444763.808 4528911.911)</td>
    </tr>
    <tr>
      <th>248269</th>
      <td>1</td>
      <td>POINT (444764.808 4528911.911)</td>
    </tr>
    <tr>
      <th>248767</th>
      <td>1</td>
      <td>POINT (444762.808 4528910.911)</td>
    </tr>
  </tbody>
</table>
<p>25141 rows × 2 columns</p>
</div>
</div>
</div>
<p>Si è ottenuto un GeoDataFrame di punti, ma a me interessano i poligoni, quindi creo un buffer intorno ai punti in modo da riprodurre i pixel del raster con cui ho iniziato l’analisi. Quindi devo andare ad individuare la risoluzione del mio raster di partenza:</p>
<div class="cell" data-execution_count="21">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> raster.rio.resolution()</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Il raster di partenza ha una risoluzione di </span><span class="sc">{</span>x<span class="sc">}</span><span class="ss"> x </span><span class="sc">{</span>y<span class="op">*-</span><span class="dv">1</span><span class="sc">}</span><span class="ss"> metri"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Il raster di partenza ha una risoluzione di 1.0 x 1.0 metri</code></pre>
</div>
</div>
<p>Ora posso creare i miei poligoni.</p>
<div class="cell" data-execution_count="22">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>gdf_polygon <span class="op">=</span> gdf_point.<span class="bu">buffer</span>(distance<span class="op">=</span><span class="fl">0.5</span>, cap_style<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>polygons <span class="op">=</span> gdf_polygon.unary_union</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> gpd.GeoDataFrame(geometry<span class="op">=</span>gpd.GeoSeries(polygons), crs<span class="op">=</span>gdf_polygon.crs).explode(index_parts<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>gdf.insert(loc<span class="op">=</span><span class="dv">1</span>, column<span class="op">=</span><span class="st">"superficie_mq"</span>, value<span class="op">=</span>gdf.geometry.area)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>gdf</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>geometry</th>
      <th>superficie_mq</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="11" valign="top">0</th>
      <th>0</th>
      <td>POLYGON ((444503.308 4528932.411, 444503.308 4...</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POLYGON ((444505.308 4528934.411, 444506.308 4...</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POLYGON ((444501.308 4528936.411, 444501.308 4...</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POLYGON ((444504.308 4528937.411, 444504.308 4...</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POLYGON ((444500.308 4528947.411, 444500.308 4...</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2284</th>
      <td>POLYGON ((444989.308 4529288.411, 444989.308 4...</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2285</th>
      <td>POLYGON ((444980.308 4529322.411, 444980.308 4...</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2286</th>
      <td>POLYGON ((444980.308 4529325.411, 444981.308 4...</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2287</th>
      <td>POLYGON ((444992.308 4529354.411, 444992.308 4...</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2288</th>
      <td>POLYGON ((444985.308 4529360.411, 444984.308 4...</td>
      <td>18.0</td>
    </tr>
  </tbody>
</table>
<p>2289 rows × 2 columns</p>
</div>
</div>
</div>
<p>Ho ottenuto un GeoDataFrame con i dati di mio interesse. Quando scrissi l’articolo del <a href="https://massimilianomoraca.it/blog/gis/fotovoltaico-e-gis-come-individuare-lutilizzabilita-di-un-tetto/">blog</a>, oramai 6 annifa, 1 kwp occupava 7 metri quadri; non conosco i risvolti del mercato attuale ma ricordo che con la minuaturizzazione si andava verso la riduzione della superficie utile per produrre 1 kwp. Anche per questo articolo mi atterrò al dato del 2018 ma, prima di calcolare la produzione potenziale di energia dell’are in esame, andrò a filtrare tutto ciò che è inferiore a 7 metri quadri.</p>
<div class="cell" data-execution_count="23">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>final_analysis <span class="op">=</span> gdf[gdf.superficie_mq <span class="op">&gt;=</span> <span class="dv">7</span>].reset_index()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>final_analysis <span class="op">=</span> final_analysis[[<span class="st">'geometry'</span>, <span class="st">'superficie_mq'</span>]]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>final_analysis.insert(loc<span class="op">=</span><span class="dv">2</span>, column<span class="op">=</span><span class="st">"potential_production_kw"</span>, value<span class="op">=</span>final_analysis.superficie_mq<span class="op">*</span><span class="dv">7</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>final_analysis</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>geometry</th>
      <th>superficie_mq</th>
      <th>potential_production_kw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>POLYGON ((444500.308 4528947.411, 444500.308 4...</td>
      <td>8.0</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>POLYGON ((444506.308 4528961.411, 444507.308 4...</td>
      <td>8.0</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>POLYGON ((444518.308 4528970.411, 444519.308 4...</td>
      <td>35.0</td>
      <td>245.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>POLYGON ((444518.308 4528967.411, 444519.308 4...</td>
      <td>9.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>POLYGON ((444524.308 4529036.411, 444525.308 4...</td>
      <td>24.0</td>
      <td>168.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>641</th>
      <td>POLYGON ((444988.308 4529225.411, 444989.308 4...</td>
      <td>12.0</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>642</th>
      <td>POLYGON ((444985.308 4529260.411, 444986.308 4...</td>
      <td>16.0</td>
      <td>112.0</td>
    </tr>
    <tr>
      <th>643</th>
      <td>POLYGON ((444985.308 4529279.411, 444986.308 4...</td>
      <td>9.0</td>
      <td>63.0</td>
    </tr>
    <tr>
      <th>644</th>
      <td>POLYGON ((444987.308 4529283.411, 444987.308 4...</td>
      <td>22.0</td>
      <td>154.0</td>
    </tr>
    <tr>
      <th>645</th>
      <td>POLYGON ((444985.308 4529360.411, 444984.308 4...</td>
      <td>18.0</td>
      <td>126.0</td>
    </tr>
  </tbody>
</table>
<p>646 rows × 3 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="24">
<details>
<summary>Codice</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>final_view <span class="op">=</span> final_analysis.plot(column<span class="op">=</span><span class="st">"potential_production_kw"</span>, cmap<span class="op">=</span><span class="st">"gnuplot"</span>, ax<span class="op">=</span>ax, legend<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>cx.add_basemap(final_view, crs<span class="op">=</span>final_analysis.crs.to_string(), source<span class="op">=</span>cx.providers.OpenStreetMap.Mapnik)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>final_view.set_title(<span class="st">"Energy production map KWP"</span>)</span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>Text(0.5, 1.0, 'Energy production map KWP')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-05-22-verificare-il-potenziale-fotovoltaico-di-un-tetto_files/figure-html/cell-25-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="conclusione" class="level1">
<h1>Conclusione</h1>
<p>La stima del potenziale produttivo di un tetto è sicuramente un passo fondamentale per capire se il tetto in esame è da considerare per una analisi più approfondita o meno. Nel processo di analisi che ho esposto ho volutamente evitato di scendere troppo nel dettaglio di analisi proprio perchè: 1. avevo interesse ad esporre un flusso di analisi; 2. avevo interesse a stimare dei valori.</p>
<p>Ad esempio un aspetto su cui ho volutamente sorvolato è il calcolo delle superfici inclinate che mi avrebbe restituito un valore di produttività per tetto differente.</p>
<p>Hai commenti, indicazioni o soluzioni alternative in Python? Scrivi nella sezione <a href="https://github.com/MaxDragonheart/PyGIS-Blog/discussions">Discussioni</a>.</p>
<section id="newsletter" class="level2">
<h2 class="anchored" data-anchor-id="newsletter">Newsletter</h2>
<p>Se vuoi ricevere aggiornamenti sui prossimi articoli <a href="https://massimilianomoraca.it/newsletter/">iscriviti alla newsletter</a>!</p>
</section>
<section id="telegram" class="level2">
<h2 class="anchored" data-anchor-id="telegram">Telegram</h2>
<p>Segui il canale Telegram <strong><a href="https://t.me/caffegis">CaffèGIS - I GIS a supporto dei processi evolutivi territoriali</a></strong> per ricevere aggiornamenti su iniziative ed informazioni a tema GIS.</p>
</section>
<section id="offrimi-una-birra" class="level2">
<h2 class="anchored" data-anchor-id="offrimi-una-birra">Offrimi una birra!</h2>
<p><strong>Se trovi interessanti i miei articoli <a href="https://www.paypal.com/paypalme/MassimilianoMoraca">offrimi una birra</a>!</strong></p>
<p>Alla prossima!</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiato!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiato!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/massimilianomoraca">LinkedIn</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://github.com/MaxDragonheart">Github</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-right">Copyright 2022, Massimiliano Moraca</div>
  </div>
</footer>



</body></html>